{
    "floors": [
        {
            "floor": 1,
            "tables": ["table001"],
            "solutionPatterns": ["SELECT\\s+\\*\\s+FROM\\s+table001"],
            "answer": "SELECT * FROM table001",
            "borrowed": [],
            "reward": {
                "gold": 10,
                "energy": 1,
                "items": []
            }
        },
        {
            "floor": 2,
            "tables": ["table002"],
            "solutionPatterns": ["SELECT\\s+message\\s+FROM\\s+table002"],
            "answer": "SELECT message FROM table002",
            "borrowed": [],
            "reward": {
                "gold": 10,
                "energy": 1,
                "items": []
            }
        },
        {
            "floor": 3,
            "tables": ["fruits"],
            "solutionPatterns": ["SELECT\\s+name,\\s*color\\s+FROM\\s+fruits\\s+WHERE\\s*color\\s*=\\s*'Red'"],
            "answer": "SELECT name, color FROM fruits WHERE color = 'Red'",
            "borrowed": ["WHERE"],
            "reward": {
                "gold": 10,
                "energy": 1,
                "items": []
            }
        },
        {
            "floor": 4,
            "tables": ["fruits"],
            "solutionPatterns": ["SELECT\\s+name,\\s*price\\s+FROM\\s+fruits\\s+ORDER\\s+BY\\s*price"],
            "answer": "SELECT name, price FROM fruits ORDER BY price",
            "borrowed": ["ORDER", "BY"],
            "reward": {
                "gold": 10,
                "energy": 1,
                "items": []
            }
        },
        {
            "floor": 5,
            "tables": ["fruits"],
            "solutionPatterns": ["SELECT\\s+color,\\s*COUNT\\(\\s*(?:\\*|id)\\s*\\)\\s+FROM\\s+fruits\\s+GROUP\\s+BY\\s+color"],
            "answer": "SELECT color, COUNT(*) FROM fruits GROUP BY color",
            "borrowed": ["COUNT", "GROUP", "BY"],
            "reward": {
                "gold": 20,
                "energy": 2,
                "items": []
            }
        },
        {
            "floor": 6,
            "tables": ["products"],
            "solutionPatterns": ["SELECT\\s+name,\\s*price\\s+FROM\\s+products\\s+WHERE\\s*price\\s*>=\\s*1000"],
            "answer": "SELECT name, price FROM products WHERE price >= 1000",
            "borrowed": ["WHERE"],
            "reward": {
                "gold": 100,
                "energy": 5,
                "items": ["WHERE"]
            },
            "hint": "特定の条件に合う行を絞り込むには `WHERE` 句を使う。"
        },
        {
            "floor": 7,
            "tables": ["monsters"],
            "solutionPatterns": ["SELECT\\s+species,\\s*COUNT\\(\\s*(?:\\*|monster_id)\\s*\\)\\s+FROM\\s+monsters\\s+GROUP\\s+BY\\s+species"],
            "answer": "SELECT species, COUNT(*) FROM monsters GROUP BY species",
            "borrowed": ["COUNT", "GROUP", "BY"],
            "reward": {
                "gold": 150,
                "energy": 5,
                "items": ["COUNT", "GROUP", "BY"]
            },
            "hint": "グループごとに集計するには `GROUP BY` 句を使う。"
        },
        {
            "floor": 8,
            "tables": ["employees", "departments"],
            "specialValidation": true,
            "answer": "SELECT emp_name, dept_name FROM employees INNER JOIN departments ON employees.dept_id = departments.dept_id",
            "borrowed": ["INNER", "JOIN", "ON", "AS"],
            "reward": {
                "gold": 200,
                "energy": 5,
                "items": ["INNER", "JOIN", "ON", "AS"]
            },
            "hint": "2つのテーブルを共通の列で結びつけるには `INNER JOIN ... ON ...` を使う。",
            "opensShop": true
        },
        {
            "floor": 9,
            "tables": ["sales", "employees", "departments"],
            "solutionPatterns": ["SELECT\\s+SUM\\(quantity\\)\\s+FROM\\s+sales\\s+WHERE\\s+emp_id\\s+IN\\s*\\(\\s*SELECT\\s+emp_id\\s+FROM\\s+employees\\s+WHERE\\s+dept_id\\s*=\\s*\\(\\s*SELECT\\s+dept_id\\s+FROM\\s+departments\\s+WHERE\\s+dept_name\\s*=\\s*'開発部'\\s*\\)\\s*\\)"],
            "answer": "SELECT SUM(quantity) FROM sales WHERE emp_id IN (SELECT emp_id FROM employees WHERE dept_id = (SELECT dept_id FROM departments WHERE dept_name = '開発部'))",
            "borrowed": ["SUM", "IN"],
            "reward": {
                "gold": 300,
                "energy": 5,
                "items": ["SUM", "IN"]
            },
            "hint": "`WHERE`句の中に別の`SELECT`文（サブクエリ）を入れることで、段階的に条件を絞り込める。"
        },
        {
            "floor": 10,
            "tables": ["sales", "employees", "departments"],
            "specialValidation": true,
            "answer": "SELECT dept_name, SUM(quantity) FROM sales INNER JOIN employees ON sales.emp_id = employees.emp_id INNER JOIN departments ON employees.dept_id = departments.dept_id WHERE sale_date >= '2025-02-01' GROUP BY dept_name HAVING SUM(quantity) >= 10",
            "borrowed": ["HAVING"],
            "reward": {
                "gold": 500,
                "energy": 10,
                "items": []
            },
            "hint": "3つのテーブルをJOINし、WHEREで日付を絞り、GROUP BYで集計し、HAVINGで最終絞込を行うのだ！",
            "opensShop": true
        }
    ]
}